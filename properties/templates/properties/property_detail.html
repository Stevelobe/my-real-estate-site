{% extends "base.html" %}
{% load static %}

{% block title %}{{ property.title }} - FAKEMA Real Estate{% endblock %}

{% block content %}
    <section style="background-color: #007bff; color: white; padding: 30px 20px; text-align: center;">
        <h1>{{ property.title }}</h1>
        <p>{{ property.location }}</p>
    </section>

    <section style="padding: 40px 0;">
        <div style="display: flex; flex-wrap: wrap; gap: 20px;">
            <div style="flex: 2 1 600px;">
                <div style="margin-bottom: 20px;">
                    {% if images %}
                        <div class="image-gallery" id="image-gallery">
                            {% for img in images %}
                                <img src="{{ img.image.url }}" alt="{{ img.alt_text|default:property.title }}">
                            {% endfor %}
                        </div>
                    {% else %}
                        <img src="{% static 'img/placeholder.jpg' %}" alt="No image available" style="width: 100%; height: 400px; object-fit: cover;">
                    {% endif %}
                </div>

                <div class="card">
                    <h2>Property Overview</h2>
                    <p><strong>Type:</strong> {{ property.property_type.name }}</p>
                    <p><strong>Price:</strong> FCFA {{ property.price }}</p>
                    <p><strong>Bedrooms:</strong> {{ property.bedrooms }}</p>
                    <p><strong>Bathrooms:</strong> {{ property.bathrooms }}</p>
                    {% if property.area_sqm %}<p><strong>Area:</strong> {{ property.area_sqm }} m²</p>{% endif %}
                    {% if property.land_area_sqm %}<p><strong>Land Area:</strong> {{ property.land_area_sqm }} m²</p>{% endif %}
                    <p><strong>Location:</strong> {{ property.location }}</p>
                    {% if property.address %}<p><strong>Address:</strong> {{ property.address }}</p>{% endif %}
                    <p><strong>Published:</strong> {{ property.published_date|date:"M d, Y" }}</p>
                </div>

                <div class="card">
                    <h2>Description</h2>
                    <p>{{ property.description|linebreaksbr }}</p>
                </div>
            </div>

            <div style="flex: 1 1 300px; background-color: #f0f8ff; padding: 20px; border: 1px solid #add8e6; border-radius: 5px;">
                <h2>Inquire About This Property</h2>
                
                {% if messages %}
                    <ul class="messages">
                        {% for message in messages %}
                            <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
                        {% endfor %}
                    </ul>
                {% endif %}

                <form method="post">
                    {% csrf_token %}
                    {{ form.property }} {# Hidden input #}

                    <div class="form-group">
                        <label for="{{ form.name.id_for_label }}">Name</label>
                        {{ form.name }}
                        {% if form.name.errors %}<p style="color: red; font-size: 0.9em;">{{ form.name.errors }}</p>{% endif %}
                    </div>
                    <div class="form-group">
                        <label for="{{ form.email.id_for_label }}">Email</label>
                        {{ form.email }}
                        {% if form.email.errors %}<p style="color: red; font-size: 0.9em;">{{ form.email.errors }}</p>{% endif %}
                    </div>
                    <div class="form-group">
                        <label for="{{ form.phone.id_for_label }}">Phone (Optional)</label>
                        {{ form.phone }}
                        {% if form.phone.errors %}<p style="color: red; font-size: 0.9em;">{{ form.phone.errors }}</p>{% endif %}
                    </div>
                    <div class="form-group">
                        <label for="{{ form.message.id_for_label }}">Message</label>
                        {{ form.message }}
                        {% if form.message.errors %}<p style="color: red; font-size: 0.9em;">{{ form.message.errors }}</p>{% endif %}
                    </div>
                    <button type="submit" class="btn">Send Inquiry</button>
                </form>
            </div>
        </div>
    </section>
{% endblock %}

{% block extra_js %}
<script>
    // Basic JS for image gallery scrolling - no dots or complex UI
    document.addEventListener('DOMContentLoaded', function() {
        const gallery = document.getElementById('image-gallery');
        if (gallery) {
            // Optional: add navigation buttons later if needed
            // For now, it's just a scrollable container.
        }
    });
</script>
{% endblock %}